---
title: "Lab 2 - Data wrangling"
author: "Derek Dubrule. Student"
date: "2026-02-05"
format: 
  html: default # for speed
  pdf: default # for final output

---


```{r}
#| eval: true
#| message: false

library(tidyverse)
```


# Questions

## Part 1

### Question 1

```{r}
midwest |>
  group_by(state) |>
  summarise(num_counties = n()) |>
  arrange(desc(num_counties))
```

Illinois (IL) has the most amount of counties at 102.

Wisconsin (WI) has the least amount of counties at 72.

\newpage

### Question 2
```{r}
midwest |>
  count(county) |>
  filter(n == n_distinct(midwest$state))
 
```

The counties of CRAWFORD, JACKSON, and MONROE could fill in this blank as these county names appear once in each of the 5 states.

\newpage

### Question 3
```{r}
# Question 3a - population density > 250000
midwest |>
  filter(popdensity > 25000) |>
  select(
    county,
    state,
    popdensity,
    poptotal,
    area
  ) |>
  arrange(desc(popdensity))
```
```{r}
# Question 3b - max population density
midwest |>
  filter(popdensity == max(popdensity)) |>
  select(
    county,
    state,
    popdensity,
    poptotal,
    area
  )
```

\newpage

### Question 4

```{r}
midwest |>
  summarise(
    normal_popdensity = median(popdensity, na.rm = TRUE),
    middle_popdensity_25 = quantile(popdensity, 0.25, na.rm = TRUE),
    middle_popdensity_75 = quantile(popdensity, 0.75, na.rm = TRUE)
  )
  
```
The distribution of population density of counties is unimodal and extremely right-skewed. A typical Midwestern county has population density of 1156 people per unit area. The middle 50% of the counties have population densities between 622 to 2330 people per unit area.

\newpage

### Question 5
```{r}
midwest |>
  mutate(metro = if_else(inmetro == 1, "Yes", "No")) |>
  group_by(state, metro) |>
  summarise(n = n(), .groups = "drop") |>
  group_by(state) |>
  mutate(proportion = n / sum(n)) |>
  arrange(state, desc(metro))
```


\newpage

### Question 6

```{r}
# Question 6a - Upper Left Corner
midwest |>
  filter(
    percbelowpoverty > 40,
    percollege < 10
  ) |>
  select(
    county,
    state,
    percbelowpoverty,
    percollege
  )
```
```{r}
# Question 6b - bottom left corner
midwest |>
  filter(
    percbelowpoverty < 20,
    percollege > 40
  ) |>
  select(
    county,
    state,
    percbelowpoverty,
    percollege
  )
```

```{r}
# Question 6c - Combine the previous 2 pipelines
midwest |>
  filter(
        (percbelowpoverty > 40 & percollege < 10) |
        (percbelowpoverty < 20 & percollege > 40)
  ) |>
  select(
    county,
    state,
    percbelowpoverty,
    percollege
  )
```

```{r}
# Question 6d - new variable
midwest |>
  mutate(
    potential_outlier = if_else(
        (percbelowpoverty > 40 & percollege < 10) |
        (percbelowpoverty < 20 & percollege > 40),
        "Yes",
        "No"
    )
  ) |>
  select(
    county,
    state,
    percbelowpoverty,
    percollege,
    potential_outlier
  ) |>
  arrange(potential_outlier)
```

```{r}
# Question 6e - visualization

midwest |>
  mutate(
    potential_outlier = if_else(
        (percbelowpoverty > 40 & percollege < 10) |
        (percbelowpoverty < 20 & percollege > 40),
        "Yes",
        "No"
    )
  ) |>
  ggplot(aes(
    x = percollege,
    y = percbelowpoverty,
    color = potential_outlier,
    shape = state
  )) +
  geom_point() +
  labs(
    x = "Percentage of population with a college degree",
    y = "Percentage of population below poverty", 
    title = "Percentage below poverty vs college education in Midwestern counties",
    color = "State",
    shape = "State"
  )

```


\newpage

### Question 7
```{r}
# Question 7a - total population for each state
state_population <- midwest |>
  group_by(state) |>
  summarise(total_population = sum(poptotal, na.rm = TRUE)) |>
  arrange(desc(total_population))

state_population

```
```{r}
# Question 7b - proportion of the total population
proportion_of_population <- state_population |>
  mutate(proportion_of_population = total_population / sum(total_population)) |>
  arrange(desc(proportion_of_population))

proportion_of_population
  
```

```{r}
# Question 7c - Most populous state
proportion_of_population |>
  slice(c(1, n())) |>
  mutate(population_percent = 100 * proportion_of_population) 
```

The state that is the most populous is IL with a total population of 11430602 with a population % of 27.20993. And the state with the lowest population is WI with a total population of 4891769 with a population % of 11.64459.

\newpage

### Question 8

\newpage

## Part 2


### Question 9

